<!doctype html>
<html lang="fr">
<head>
  <link rel="stylesheet" href="si28.css" />
  <title>Du debut en oiio</title>
</head>

<body bgcolor="#000000">
    <div id="container"></div>
    <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.4.2.min.js"></script>
    <script defer="defer">
      var stage = new Kinetic.Stage({
        container: 'container',
        width: 1024,
        height: 720
      });
      var layer = new Kinetic.Layer();

      /////////////////////////////
      //          OIIO           //
      var oiio_h = new Kinetic.Text({
        x: stage.getWidth() / 2,
        y: 15,
        text: 'OIIO',
        fontSize: 30,
        fontFamily: 'Demihaut_haut',
        fill: 'green'
      });

      oiio_h.setOffset({ // align text on the center
        x: oiio_h.getWidth() / 2,
        y: -320
      });


      var oiio_b = new Kinetic.Text({
        x: stage.getWidth() / 2,
        y: 15,
        text: 'OIIO',
        fontSize: 30,
        fontFamily: 'Demihaut_bas',
        fill: 'green'
      });

      oiio_b.setOffset({ // align text on the center
        x: oiio_b.getWidth() / 2,
        y: -350
      });

      /////////////////////////////
      //         Phrases         //
      var phrase1 = new Kinetic.Text({
        x: stage.getWidth() / 2,
        y: 15,
        text: 'LE COMMENCEMENT DES CHOSES \n ETAIT UN DEBUT POUR LES',
        fontSize: 60,
        fontFamily: 'Demihaut',
        fill: 'green' 
      })   

      phrase1.setOffset({ // align text on the center
        x: oiio_b.getWidth() / 2,
        y: -350
      });


      /////////////////////////////
      //       Animations        //
      /////////////////////////////
      var anim_explosion = new Kinetic.Animation( function(frame) {
        var time = frame.time,
        timeDiff = frame.timeDiff,
        frameRate = frame.frameRate;

        oiio_h.setX(oiio_h.getX()-5);
        oiio_h.setY(oiio_h.getY()-5);

        oiio_b.setX(oiio_b.getX()+5);
        oiio_b.setY(oiio_b.getY()+5);
      }, layer );

      function view_phrase(){
        oiio_h.setText('SUR');
        oiio_h.setFontFamily('Demihaut');
        oiio_h.setFontSize(60);

        oiio_b.setText('UNS');
        oiio_b.setFontFamily('Demibas');
        oiio_b.setFontSize(60);

        layer.add(phrase1);
        stage.add(layer);
      }

      function oiio_explosion() {
        anim_explosion.start();
        setTimeout(function(){ anim_explosion.stop(); }, 500)
        setTimeout(function(){ view_phrase();}, 1000)
      }

      var anim_implosion = new Kinetic.Animation( function(frame) {
        var time = frame.time,
        timeDiff = frame.timeDiff,
        frameRate = frame.frameRate;

        oiio_h.setX(oiio_h.getX()+5);
        oiio_h.setY(oiio_h.getY()+5);

        oiio_b.setX(oiio_b.getX()-5);
        oiio_b.setY(oiio_b.getY()-5);
      }, layer );

      function oiio_implosion() {
        anim_implosion.start();
        setTimeout(function(){ anim_implosion.stop(); }, 500)
        
      }


      // add the shapes to the layer
      layer.add(oiio_h);
      layer.add(oiio_b);
      stage.add(layer);

      // core of the animation
      var it = 0;

      layer.on('click', function() {  // fonctionne en tactile avec 'touchstart'
        // phrase 1
        if(it == 0){
          oiio_explosion();
          it = 1;
        } else if(it == 1){ // faire apparaitre la phrase
          it = 2;
        } else if(it == 2){ // faire disparaitre la phrase
          phrase1.destroy();
          it = 3;
        } else if(it == 3){
          oiio_implosion();
          it = 4;
        }
      });

    </script>

</body>
</html>